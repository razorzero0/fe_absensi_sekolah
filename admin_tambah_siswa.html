<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Tambah Siswa</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />

    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #f8f9fa;
      }

      /* --- Layout Desktop Fix --- */
      .sidebar {
        min-height: 100vh;
        background: linear-gradient(180deg, #28a745, #1e7e34); /* Hijau */
        width: 280px;
        flex-shrink: 0;
      }

      /* Menonaktifkan fixed position di desktop dan memastikan layout sejajar */
      @media (min-width: 768px) {
        .sidebar {
          position: static !important;
        }
        .content-wrapper {
          margin-left: 0 !important;
        }
      }

      /* Styling Sidebar */
      .sidebar .nav-link {
        color: #ffffff;
        padding: 15px 20px;
        transition: background-color 0.3s;
        border-radius: 8px;
        margin-bottom: 5px;
      }
      .sidebar .nav-link:hover,
      .sidebar .nav-link.active {
        background-color: rgba(255, 255, 255, 0.2);
      }
      .sidebar-header {
        padding: 20px;
        color: white;
        font-size: 1.5rem;
        font-weight: 700;
      }
      .form-card {
        border-radius: 12px;
      }

      /* Offcanvas untuk Mobile */
      .offcanvas-md {
        width: 280px;
      }
    </style>
  </head>
  <body>
    <div class="d-flex">
      <nav
        class="sidebar offcanvas-md offcanvas-start d-flex flex-column p-3"
        tabindex="-1"
        id="sidebarMenu"
        aria-labelledby="sidebarMenuLabel"
      >
        <div class="offcanvas-header d-md-none">
          <h5 class="offcanvas-title text-white" id="sidebarMenuLabel">
            ADMIN Absensi
          </h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="offcanvas"
            data-bs-target="#sidebarMenu"
            aria-label="Close"
          ></button>
        </div>

        <div
          class="offcanvas-body d-md-flex flex-column p-0 pt-lg-3 overflow-y-auto"
        >
          <div class="sidebar-header text-center mb-4 d-none d-md-block">
            ADMIN Absensi
          </div>
          <nav class="nav flex-column flex-grow-1">
            <a class="nav-link" href="admin_dashboard.html">
              <i class="fas fa-home me-2"></i> Dashboard
            </a>
            <a class="nav-link active" href="admin_manajemen_siswa.html">
              <i class="fas fa-users me-2"></i> Manajemen Siswa
            </a>
            <a class="nav-link" href="admin_manajemen_absensi.html">
              <i class="fas fa-calendar-check me-2"></i> Manajemen Absensi
            </a>
            <a class="nav-link mt-auto" href="admin_login.html">
              <i class="fas fa-sign-out-alt me-2"></i> Logout
            </a>
          </nav>
        </div>
      </nav>

      <main class="content-wrapper flex-grow-1 p-3 p-md-4">
        <div class="d-md-none mb-3 d-flex align-items-center">
          <button
            class="btn btn-success"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#sidebarMenu"
            aria-controls="sidebarMenu"
          >
            <i class="fas fa-bars"></i> Menu
          </button>
          <span class="h4 ms-3 text-success">Tambah Siswa</span>
        </div>

        <h1 class="mb-4 d-none d-md-block">Form Tambah Siswa Baru</h1>

        <div class="card form-card shadow-sm">
          <div class="card-header bg-success text-white">
            <i class="fas fa-plus-circle me-2"></i> Isi Data Siswa
          </div>
          <div class="card-body">
            <form id="tambahSiswaForm" enctype="multipart/form-data">
              <div class="row g-3">
                <h5 class="mt-4 mb-3 text-success">Data Pokok</h5>

                <div class="col-md-6">
                  <label for="nis" class="form-label"
                    >NIS (Nomor Induk Siswa)</label
                  >
                  <input
                    type="text"
                    class="form-control rounded-3"
                    id="nis"
                    required
                    placeholder="Contoh: 123460"
                    pattern="[0-9]{6,10}"
                    title="NIS harus berupa angka antara 6 hingga 10 digit."
                  />
                  <div class="form-text">NIS harus unik dan wajib diisi.</div>
                </div>
                <div class="col-md-6">
                  <label for="namaLengkap" class="form-label"
                    >Nama Lengkap</label
                  >
                  <input
                    type="text"
                    class="form-control rounded-3"
                    id="namaLengkap"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="kelas" class="form-label">Kelas</label>
                  <select class="form-select rounded-3" id="kelas" required>
                    <option value="" selected disabled>Pilih Kelas...</option>
                    <option>X IPA 1</option>
                    <option>XI IPS 2</option>
                    <option>XII BAHASA 3</option>
                    <option>X IPS 1</option>
                    <option>XI IPA 2</option>
                    <option>XII IPA 3</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label for="jenisKelamin" class="form-label"
                    >Jenis Kelamin</label
                  >
                  <select
                    class="form-select rounded-3"
                    id="jenisKelamin"
                    required
                  >
                    <option value="" selected disabled>
                      Pilih Jenis Kelamin...
                    </option>
                    <option>Laki-laki</option>
                    <option>Perempuan</option>
                  </select>
                </div>

                <div class="col-md-6">
                  <label for="fotoSiswa" class="form-label"
                    >Foto Siswa (Maks. 2MB)</label
                  >
                  <input
                    type="file"
                    class="form-control rounded-3"
                    id="fotoSiswa"
                    accept="image/*"
                  />
                  <div class="form-text">
                    Pilih foto terbaru siswa (JPG/PNG).
                  </div>
                </div>
                <h5 class="mt-5 mb-3 text-success">
                  Informasi Kontak & Alamat
                </h5>
                <div class="col-md-4">
                  <label for="tempatLahir" class="form-label"
                    >Tempat Lahir</label
                  >
                  <input
                    type="text"
                    class="form-control rounded-3"
                    id="tempatLahir"
                  />
                </div>
                <div class="col-md-4">
                  <label for="tanggalLahir" class="form-label"
                    >Tanggal Lahir</label
                  >
                  <input
                    type="date"
                    class="form-control rounded-3"
                    id="tanggalLahir"
                  />
                </div>
                <div class="col-md-4">
                  <label for="teleponSiswa" class="form-label"
                    >Nomor Telepon Siswa</label
                  >
                  <input
                    type="tel"
                    class="form-control rounded-3"
                    id="teleponSiswa"
                    placeholder="Opsional"
                  />
                </div>
                <div class="col-12">
                  <label for="alamat" class="form-label">Alamat Lengkap</label>
                  <textarea
                    class="form-control rounded-3"
                    id="alamat"
                    rows="3"
                  ></textarea>
                </div>

                <h5 class="mt-5 mb-3 text-success">Data Wali</h5>
                <div class="col-md-6">
                  <label for="wali" class="form-label"
                    >Nama Wali/Orang Tua</label
                  >
                  <input
                    type="text"
                    class="form-control rounded-3"
                    id="wali"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="teleponWali" class="form-label"
                    >Nomor Telepon Wali</label
                  >
                  <input
                    type="tel"
                    class="form-control rounded-3"
                    id="teleponWali"
                    required
                  />
                </div>
              </div>

              <div class="mt-5 pt-3 border-top">
                <button type="submit" class="btn btn-success rounded-3 me-2">
                  <i class="fas fa-plus me-1"></i> Tambah Siswa
                </button>
                <a
                  href="admin_manajemen_siswa.html"
                  class="btn btn-secondary rounded-3"
                >
                  Batal
                </a>
              </div>
            </form>
          </div>
        </div>
      </main>
    </div>

    <div
      class="modal fade"
      id="addSiswaSuccessModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 border-success border-2">
          <div class="modal-header bg-success text-white">
            <h5 class="modal-title">
              <i class="fas fa-check-circle me-2"></i> Sukses!
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p id="successMessage"></p>
            <p class="text-muted small">
              Anda akan diarahkan kembali ke halaman Manajemen Siswa dalam 3
              detik.
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-success rounded-3"
              data-bs-dismiss="modal"
            >
              OK
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document
        .getElementById("tambahSiswaForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const nis = document.getElementById("nis").value;
          const nama = document.getElementById("namaLengkap").value;
          const kelas = document.getElementById("kelas").value;
          const wali = document.getElementById("wali").value;
          const foto = document.getElementById("fotoSiswa").files[0];

          // Logika simulasi penyimpanan data (Di sini Anda akan melakukan AJAX POST ke backend)
          console.log("Data Siswa Baru:");
          console.log({
            nis: nis,
            nama: nama,
            kelas: kelas,
            wali: wali,
            foto: foto ? foto.name : "Tidak ada file",
            // data lain...
          });

          // 1. Tampilkan pesan sukses di modal
          const successModal = new bootstrap.Modal(
            document.getElementById("addSiswaSuccessModal")
          );
          document.getElementById(
            "successMessage"
          ).innerHTML = `Data siswa **${nama} (${nis})** berhasil ditambahkan.`;
          successModal.show();

          // 2. Redirect setelah modal ditutup atau setelah timeout
          const modalElement = document.getElementById("addSiswaSuccessModal");

          // Redirect saat modal ditutup
          modalElement.addEventListener(
            "hidden.bs.modal",
            function () {
              window.location.href = "admin_manajemen_siswa.html";
            },
            { once: true }
          );

          // Redirect otomatis setelah 3 detik
          setTimeout(() => {
            successModal.hide(); // Sembunyikan modal (akan memicu redirect dari event listener di atas)
          }, 3000);

          // 3. Opsional: Reset form setelah berhasil
          // this.reset();
        });
    </script>
  </body>
</html>
